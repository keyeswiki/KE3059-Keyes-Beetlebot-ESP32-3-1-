# 项目11: 读取光敏传感器的值

## 1.实验简介：

我们都知道人类可以通过自己的眼睛在黑暗中寻找光源，那么机器人是怎样完成这项任务呢？让机器人完成这项任务首先需要给机器人安装上能看见光亮的眼睛，即光敏传感器，这样就能让机器人通过光源的强弱来寻找光源。我们的小车上左右各装有1个光敏传感器，当外界环境光线的强、弱发生变化的时候，光敏传感器的电阻也跟随发生相应的改变，并把这种变化传输给小车上的ESP32主板，ESP32主板就像人的大脑一样可以判断和思考，指挥着小车寻找光线。两个光敏传感器不停的检测是否有光线，检测到光线后就判断左、右两边哪个方向的光线较强，最后就指挥小车向着光线强的方向前进。

在本实验中，我们将了解光敏传感器的工作原理。

## 2.元件知识：
**光敏传感器：** 它主要采用光敏电阻元件，该电阻元件电阻大小随着光照强度的变化而变化。传感器信号端连接单片机模拟口，当光线越强时，模拟口电压越大，即单片机的模拟值也大；反之，光照强度越弱时，模拟口电压越小，即单片机的模拟值也小。这样，就可以利用光敏传感器读取对应的模拟值来反映环境光线强度。

## 3.实验接线：
通过前面的安装接线知道，两个光敏传感器的信号脚位已经接到了ESP32主板的GPIO34和GPIO35，下面我们就利用接到GPIO34的光敏传感器来完成下面的实验，首先我们来读取模拟值。
|左边光敏传感器| 小车PCB板 |
| :--: | :--: |
| G| G |
| V| V |
|S|S（GPIO34）|
![Img](/media/img-20230508101203.png)

## 4.实验代码：
左边光敏传感器是由ESP32主板的GPIO34控制。

本教程中使用的代码保存在：“**..\Keyes Beetlebot ESP32 3合1 智能小车\4. Python 教程\3. 项目教程**” 的路径中。你可以把代码移到任何地方。例如，我们将代码保存在**D盘**中，<span style="color: rgb(0, 209, 0);">路径为D:\3. 项目教程</span>。
![Img](/media/img-20230331170623.png)

打开“**Thonny**”软件，点击“**此电脑**”→“**D:**”→“**3. 项目教程**”→“**项目11 读取光敏传感器的值**”，然后鼠标左键双击“**Project_11_Read_Photosensor_Value.py**”。
![Img](/media/img-20230403141704.png)

```
from machine import ADC, Pin
import time
# 初始化GPIO34引脚的光阻(ADC函数)
adc = ADC(Pin(34))
adc.atten(ADC.ATTN_11DB)
adc.width(ADC.WIDTH_10BIT)

# 循环打印光敏传感器的adc值
try:
    while True:
        adcValue = adc.read() # 读取光敏传感器的ADC值
        print("ADC Value:", adcValue) #发送光敏传感器ADC值并打印结果.
        time.sleep(0.5)
except:
    pass
    
```

## 5.实验现象：
确保ESP32主板已经连接到电脑上，单击“![Img](/media/img-20230403103800.png)”。
![Img](/media/img-20230403141758.png)

单击“![Img](/media/img-20230403103831.png)”，代码开始执行，你会看到的现象是：当光线增强时，Thonny IDE下的“Shell”窗口中打印模拟值增大；反之，打印的模拟值减小。按“Ctrl+C”或单击“![Img](/media/img-20230403103911.png)”退出程序。
![Img](/media/img-20230403142012.png)
![Img](/media/img-20230403142038.png)










